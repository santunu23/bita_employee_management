<app-navbar></app-navbar>

<div class="container mt-4 mb-5">
  <ngx-spinner bdColor="rgba(51,51,51,0.8)" size="medium" color="#fff" type="ball-scale-multiple">
    <p style="font-size: 20px; color: white">Please Wait...</p>
  </ngx-spinner>

  <div class="row justify-content-center">
    <div class="col-12 col-lg-10">
      <h1 class="headerfont text-center text-md-left">Work Experience</h1>
      <hr class="headerline">

      <mat-card class="mb-4 p-3 p-md-4">
        <form [formGroup]="trainingDataForm" (ngSubmit)="saveAllData()">
          
          <div formArrayName="training">
            <div *ngFor="let exp of training.controls; let i=index" [formGroupName]="i" class="card mb-4 border-info shadow-sm">
              
              <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center py-2 px-3">
                <h5 class="mb-0">Training #{{i+1}}</h5>
                <button *ngIf="i > 0" type="button" class="btn btn-danger btn-sm rounded-circle" (click)="removeExperience(i)">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>

              <div class="card-body p-3">
                <div class="row">
                  <div class="col-12 col-md-6 mb-2">
                    <mat-form-field class="w-100" appearance="outline">
                      <mat-label>Training Title</mat-label>
                      <input type="text" formControlName="trainingtitle" required matInput placeholder="e.g. PSEA Orientation/ AI Workshop">
                      <mat-icon matSuffix>school</mat-icon>
                    </mat-form-field>
                  </div>
                    <div class="col-12 col-md-6 mb-2">
                    <mat-form-field class="w-100" appearance="outline">
                      <mat-label>Organization</mat-label> 
                      <input type="text" formControlName="organization" required matInput placeholder="e.g. BITA / Google">
                      <mat-icon matSuffix>business</mat-icon>
                    </mat-form-field>
                  </div>
                   <div class="col-12 col-sm-6 col-md-4 mb-2">
                    <mat-form-field class="w-100" appearance="outline">
                      <mat-label>Date</mat-label>
                      <input matInput type="date" formControlName="trainingdate" required>
                    </mat-form-field>
                  </div>
                  <div class="col-12 col-md-6 mb-2">
                    <mat-form-field class="w-100" appearance="outline">
                        <mat-label>Duration (in days)</mat-label>
                        <input type="number" formControlName="durration" required matInput placeholder="e.g. 30">
                        <mat-icon matSuffix>schedule</mat-icon>
                        <mat-hint>Input total number of days</mat-hint>
                    </mat-form-field>
                    </div>


                </div>
              </div>
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-12 text-center mb-4">
              <button type="button" class="btn btn-warning shadow-sm px-4" (click)="addtrainingForm()">
                <mat-icon class="align-middle mr-1">add_circle</mat-icon> Add More Training
              </button>
            </div>
            
            <div class="col-12 col-md-6 offset-md-3">
              <button 
                type="submit" 
                class="btn btn-success btn-lg btn-block shadow-lg py-3 font-weight-bold d-flex align-items-center justify-content-center"
                [disabled]="!trainingDataForm.valid">
                <mat-icon class="mr-2">cloud_upload</mat-icon> 
                SUBMIT Training Data
              </button>
            </div>
          </div>

        </form>
      </mat-card>
      <h2 class="headerfont mt-5 text-center text-md-left">Saved Training Records</h2>
      <hr class="headerline">
      <mat-card class="shadow-sm p-0 overflow-hidden mb-5">
        <div class="table-responsive">
          <table mat-table [dataSource]="trainingList" class="w-100">

            <ng-container matColumnDef="title">
              <th mat-header-cell *matHeaderCellDef class="bg-light font-weight-bold"> Title </th>
              <td mat-cell *matCellDef="let element"> {{element.trainingtitle}} </td>
            </ng-container>

            <ng-container matColumnDef="organization">
              <th mat-header-cell *matHeaderCellDef class="bg-light font-weight-bold"> Organization </th>
              <td mat-cell *matCellDef="let element"> {{element.organization}} </td>
            </ng-container>

            <ng-container matColumnDef="duration">
              <th mat-header-cell *matHeaderCellDef class="bg-light font-weight-bold"> Duration (Days) </th>
              <td mat-cell *matCellDef="let element"> {{element.durration}} </td>
            </ng-container>

            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef class="bg-light font-weight-bold text-center"> Action </th>
              <td mat-cell *matCellDef="let element; let i = index" class="text-center">
                <button mat-icon-button color="warn" (click)="deleteTraining(i)">
                  <mat-icon>delete_sweep</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

          </table>

          <div *ngIf="trainingList.length === 0" class="text-center p-5 text-muted">
            <mat-icon style="font-size: 48px; height: 48px; width: 48px;">assignment_late</mat-icon>
            <p class="mt-2">No training records found in database.</p>
          </div>
        </div>
      </mat-card>
    </div>
  </div>
</div>
