<app-navbar></app-navbar>
<div class="container mt-4 mb-5">
  <ngx-spinner bdColor="rgba(51,51,51,0.8)" size="medium" color="#fff" type="ball-scale-multiple">
    <p style="font-size: 20px; color: white">Please Wait...</p>
  </ngx-spinner>

  <div class="row justify-content-center">
    <div class="col-12 col-lg-10">
      <h1 class="headerfont text-center text-md-left">Work Experience</h1>
      <hr class="headerline">

      <mat-card class="mb-4 p-3 p-md-4">
        <form [formGroup]="experienceForm" (ngSubmit)="saveAllData()">
          
          <div formArrayName="workExperience">
            <div *ngFor="let exp of experiences.controls; let i=index" [formGroupName]="i" class="card mb-4 border-info shadow-sm">
              
              <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center py-2 px-3">
                <h5 class="mb-0">Experience #{{i+1}}</h5>
                <button *ngIf="i > 0" type="button" class="btn btn-danger btn-sm rounded-circle" (click)="removeExperience(i)">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>

              <div class="card-body p-3">
                <div class="row">
                  <div class="col-12 col-md-6 mb-2">
                    <mat-form-field class="w-100" appearance="outline">
                      <mat-label>Company Name</mat-label>
                      <input type="text" formControlName="companyName" required matInput placeholder="e.g. BITA / Google">
                      <mat-icon matSuffix>business</mat-icon>
                    </mat-form-field>
                  </div>

                  <div class="col-12 col-md-6 mb-2">
                    <mat-form-field class="w-100" appearance="outline">
                      <mat-label>Designation</mat-label>
                      <input type="text" formControlName="designation" required matInput placeholder="e.g. Software Developer">
                      <mat-icon matSuffix>work_outline</mat-icon>
                    </mat-form-field>
                  </div>

                  <div class="col-12 col-sm-6 col-md-4 mb-2">
                    <mat-form-field class="w-100" appearance="outline">
                      <mat-label>Start Date</mat-label>
                      <input matInput type="date" formControlName="startDate" required>
                    </mat-form-field>
                  </div>

                  <div class="col-12 col-sm-6 col-md-4 mb-2">
                    <mat-form-field class="w-100" appearance="outline">
                      <mat-label>End Date</mat-label>
                      <input matInput type="date" formControlName="endDate">
                    </mat-form-field>
                  </div>

                  <div class="col-12 col-md-4 d-flex align-items-center mb-3">
                    <mat-checkbox formControlName="isCurrent" color="primary">Currently Working Here</mat-checkbox>
                  </div>

                  <div class="col-12">
                    <mat-form-field class="w-100" appearance="outline">
                      <mat-label>Job Responsibility</mat-label>
                      <textarea matInput formControlName="jobResponsibility" rows="3" placeholder="Describe your key roles..."></textarea>
                      <mat-icon matSuffix>description</mat-icon>
                    </mat-form-field>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-12 text-center mb-4">
              <button type="button" class="btn btn-warning shadow-sm px-4" (click)="addExperience()">
                <mat-icon class="align-middle mr-1">add_circle</mat-icon> Add More Experience
              </button>
            </div>
            
            <div class="col-12 col-md-6 offset-md-3">
              <button 
                type="submit" 
                class="btn btn-success btn-lg btn-block shadow-lg py-3 font-weight-bold d-flex align-items-center justify-content-center"
                [disabled]="!experienceForm.valid">
                <mat-icon class="mr-2">cloud_upload</mat-icon> 
                SUBMIT REGISTRATION
              </button>
            </div>
          </div>

        </form>
      </mat-card>
    </div>
  </div>
<div class="mt-4 card shadow-sm">
  <table mat-table [dataSource]="this.workExperienceList" class="mat-elevation-z8 w-100">
    <ng-container matColumnDef="company">
      <th mat-header-cell *matHeaderCellDef> Organization </th>
      <td mat-cell *matCellDef="let element"> {{element.companyName}} </td>
    </ng-container>

    <ng-container matColumnDef="position">
      <th mat-header-cell *matHeaderCellDef> Position </th>
      <td mat-cell *matCellDef="let element"> {{element.designation}} </td>
    </ng-container>

    <ng-container matColumnDef="duration">
      <th mat-header-cell *matHeaderCellDef> Duration </th>
      <td mat-cell *matCellDef="let element"> 
        {{element.startDate}} to {{element.isCurrent ? 'Present' : element.endDate}} 
      </td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef> Actions </th>
      <td mat-cell *matCellDef="let element; let i = index">
        <button mat-icon-button color="warn" (click)="removeExperiencedata(i)">
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"> Outreach</tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</div>
</div>